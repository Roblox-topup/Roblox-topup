<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Top Up Robux</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
  body {
  background: #ffffff;  /* putih */
  color: #000000;       /* teks hitam */
  min-height: 100vh;
  }
  @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
  .container { max-width: 100%; margin: auto; min-height: 100vh; position: relative; }
  
  .hero-header { background: rgba(255, 255, 255, 0.95); padding: 20px; }
  .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
  .hero-title { font-size: 28px; font-weight: 700; color: #000; }
  .user-controls { display: flex; align-items: center; }
  .cart-btn { background: none; border: none; cursor: pointer; position: relative; }
  .cart-count { position: absolute; top: -8px; right: -8px; background: red; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; }
  
  .search-container { margin-bottom: 15px; }
  .search-box { width: 100%; padding: 12px 20px; border: 2px solid #ddd; border-radius: 25px; font-size: 16px; color: #000; background: white; }
  
  .nav-sections { display: flex; gap: 10px; overflow-x: auto; }
  .nav-btn { background: rgba(0, 0, 0, 0.1); border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; color: #000; font-weight: 500; white-space: nowrap; transition: all 0.3s ease; }
  .nav-btn:hover, .nav-btn.active { background: #000; color: white; }
  
  .shop-header { background: rgba(255, 255, 255, 0.9); padding: 20px; color: #000; }
  .shop-title { font-size: 20px; font-weight: 600; }
  .product-selection { padding: 20px; background: rgba(255, 255, 255, 0.95); }
  .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
  .product-card { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); color: #000; transition: transform 0.3s ease; padding: 15px; }
  .product-card:hover { transform: translateY(-2px); }
  .product-info { padding: 10px; }
  .product-name { font-size: 18px; font-weight: 600; margin-bottom: 10px; }
  .add-btn { background: rgba(0, 0, 0, 0.1); border: none; padding: 10px 16px; border-radius: 20px; cursor: pointer; color: #000; font-weight: 500; transition: all 0.3s ease; }
  .add-btn:hover { background: rgba(0, 0, 0, 0.8); color: white; }
  .input-field { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 10px; color: #000; font-size: 16px; }
  .product-image { background-size: cover; background-position: center; position: relative; }
  .product-price { position: absolute; top: 10px; right: 10px; background: rgba(255, 255, 255, 0.9); color: #000; padding: 5px 10px; border-radius: 15px; font-weight: 600; font-size: 14px; }
  
  .checkout-section { display: none; background: rgba(255, 255, 255, 0.95); min-height: 100vh; padding: 20px; color: #000; }
  .checkout-header { display: flex; justify-content: center; align-items: center; position: relative; padding: 20px 0; }
  .checkout-title { font-size: 28px; font-weight: 700; color: #000; }
  .close-checkout { position: absolute; left: 0; background: none; border: none; color: #000; font-size: 28px; font-weight: 700; cursor: pointer; }
  .receipt-container { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); margin-top: 20px; }
  .receipt-header { background: linear-gradient(135deg, #000, #333); padding: 20px; color: white; text-align: center; }
  .receipt-title { font-weight: 700; font-size: 24px; margin-bottom: 5px; }
  .receipt-subtitle { font-weight: 400; font-size: 14px; opacity: 0.8; }
  .receipt-items { padding: 15px; }
  .receipt-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px dashed #ccc; }
  .item-name-receipt { font-weight: 600; color: #000; }
  .item-qty-price { font-size: 14px; color: #333; display: flex; align-items: center; gap: 6px; }
  .qty-btn { background: #000; border: none; color: white; font-weight: 700; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; }
  .summary-row-receipt { display: flex; justify-content: space-between; padding: 10px 15px; font-weight: 700; color: #000; font-size: 18px; }
  .confirm-btn { background: #000; color: white; padding: 15px; border: none; border-radius: 20px; cursor: pointer; margin-top: 20px; width: 100%; font-size: 16px; font-weight: 600; }
</style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div id="mainHeader" class="hero-header">
      <div class="header-top">
        <div class="hero-title">Top Up Robux</div>
        <div class="user-controls">
          <button class="cart-btn" id="cart-button" onclick="showCheckout()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
            <span class="cart-count" id="cart-count">0</span>
          </button>
        </div>
      </div>
      
      <div class="search-container">
        <input type="text" id="searchBox" class="search-box" placeholder="Cari produk..." onkeyup="searchProducts()" />
      </div>
      
      <div class="nav-sections">
        <button class="nav-btn active" onclick="filterProducts('all')">Home</button>
        <button class="nav-btn" onclick="filterProducts('garden')">Grow a Garden</button>
        <button class="nav-btn" onclick="filterProducts('robux')">Robux</button>
       <button class="nav-btn" onclick="filterProducts('blox')">Blox Fruits</button>
      </div>
    </div>
    
    <!-- Produk -->
    <div id="shopSection">
      <div class="shop-header"><div class="shop-title" id="sectionTitle">All products</div></div>
      <div class="product-selection">
        <div class="product-grid" id="productGrid">
          
          <!-- Custom Robux -->
          <div class="product-card" data-category="robux" data-name="Custom Robux">
            <div class="product-info">
              <div class="product-name">ðŸ’Ž Top Up Robux</div>
              <label>Jumlah Robux</label>
              <input type="number" id="robuxInput" min="50" step="50" class="input-field" placeholder="Contoh: 50" oninput="updateRobuxPrice()">
              <label>Harga</label>
              <input type="text" id="robuxPrice" class="input-field" readonly placeholder="Rp 0">
              <button class="add-btn" onclick="addCustomRobux()">+ Keranjang</button>
            </div>
          </div>

          <!-- Produk Lain -->
          <div class="product-card" data-category="garden" data-name="Dragon Fly">
            <div class="product-image" style="background-image:url('Dragonfly.png');height:150px;">
              <div class="product-price">Rp 35.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Dragon Fly</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('dragon-fly','Dragon Fly',35000)">+ Keranjang</button>
            </div>
          </div>
          
          <div class="product-card" data-category="garden" data-name="Red Fox">
            <div class="product-image" style="background-image:url('01k3jn1zvpg8gz5zmqgmvgmv8q.jpg');height:150px;">
              <div class="product-price">Rp 13.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Red Fox</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('red-fox','Red Fox',13000)">+ Keranjang</button>
            </div>
          </div>
    
          <div class="product-card" data-category="garden" data-name="Raccoon">
            <div class="product-image" style="background-image:url('raccoon.png');height:150px;">
              <div class="product-price">Rp 135.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Raccoon</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('raccoon','Raccoon',135000)">+ Keranjang</button>
            </div>
          </div>

         <div class="product-card" data-category="garden" data-name="Golden Goose">
            <div class="product-image" style="background-image:url('grow-a-garden-golden-goose.jpg');height:150px;">
              <div class="product-price">Rp 30.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Golden Goose</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('golden-goose','Golden Goose',30000)">+ Keranjang</button>
            </div>
         </div>

         <div class="product-card" data-category="garden" data-name="Corrupted Kitsune">
            <div class="product-image" style="background-image:url('How-to-Get-Corrupted-Kitsune-in-Grow-a-Garden-Roblox.webp');height:150px;">
              <div class="product-price">Rp 18.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Corrupted Kitsune</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('c-kitsune','Corrupted Kitsune',18000)">+ Keranjang</button>
            </div>
          </div>

         <div class="product-card" data-category="garden" data-name="Mimic Octopus">
            <div class="product-image" style="background-image:url('9594-135711429-135711.png');height:150px;">
              <div class="product-price">Rp 35.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Mimic Octopus</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('mimic','Mimic Octopus',35000)">+ Keranjang</button>
            </div>
         </div>

         <div class="product-card" data-category="blox" data-name="Gas Fruit">
            <div class="product-image" style="background-image:url('62578bbc-16be-465a-9153-6a4679909952.jpg');height:150px;">
              <div class="product-price">Rp 30.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Gas Fruit</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('gas','Gas Fruit',30000)">+ Keranjang</button>
            </div>
         </div>
         
         <div class="product-card" data-category="blox" data-name="Gravity Fruit">
            <div class="product-image" style="background-image:url('10b0a-17453373808035-1920.jpg');height:150px;">
              <div class="product-price">Rp 14.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Gravity Fruit</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('gravity','Gravity Fruit',14000)">+ Keranjang</button>
            </div>
         </div>
         <div class="product-card" data-category="blox" data-name="Spirit Fruit">
            <div class="product-image" style="background-image:url('spirit-fruit-in-blox-fruits.jpg');height:150px;">
              <div class="product-price">Rp 7.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">Spirit Fruit</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('gas','Spirit Fruit',7000)">+ Keranjang</button>
            </div>
         </div>
<div class="product-card" data-category="blox" data-name="2x Mastery">
            <div class="product-image" style="background-image:url('e9d3751e3154621df279031e4b2939b9.jpg');height:150px;">
              <div class="product-price">Rp 60.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">2x Mastery</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('gravity','2x Mastery',60000)">+ Keranjang</button>
            </div>
         </div>
         <div class="product-card" data-category="blox" data-name="2x Money">
            <div class="product-image" style="background-image:url('b9e7109dcb8065a3a307869ace056925.jpg');height:150px;">
              <div class="product-price">Rp 60.000</div>
            </div>
            <div class="product-info">
              <div class="product-name">2x Money</div>
              <button class="add-btn" onclick="event.stopPropagation(); addToCart('gas','2x Money',60000)">+ Keranjang</button>
            </div>
         </div>
     
        </div>
      </div>
    </div>
    
    <!-- Checkout -->
    <div id="checkoutSection" class="checkout-section">
      <div class="checkout-header">
        <button class="close-checkout" onclick="showShop()">Ã—</button>
        <div class="checkout-title">Receipt</div>
      </div>
      <input type="text" id="customerName" class="input-field" placeholder="Your Name" />
      <textarea id="customerUsername" class="input-field" placeholder="Username Roblox" rows="3"></textarea>
     <input type="text" id="promoCode" class="input-field" placeholder="Promo Code (Optional)" />
<button class="add-btn" onclick="applyPromo()">Gunakan Promo</button>
<p id="promoMessage" style="color:green; font-weight:600; margin-top:5px;"></p>
      <div class="receipt-container">
        <div class="receipt-header">
          <div class="receipt-title">ðŸ§¾ RECEIPT</div>
          <div class="receipt-subtitle">Deshawn Shop</div>
        </div>
        <div class="receipt-items" id="receiptItems"></div>
        <div class="summary-row-receipt"><span>Total</span><span id="summaryTotal">Rp 0</span></div>
      </div>
      <button class="confirm-btn" onclick="sendToWhatsApp()">Confirm</button>
    </div>
  </div>

    <script>
  let currentFilter = 'all';
  
  function updateCartCount(){
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let count = cart.reduce((sum, item) => sum + item.quantity, 0);
    document.getElementById('cart-count').textContent = count;
  }

  function addToCart(id, name, price){
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let item = cart.find(i => i.id === id);
    if(item){ item.quantity++; } 
    else { cart.push({ id, name, price, quantity: 1 }); }
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
  }

  function updateRobuxPrice() {
    let robux = parseInt(document.getElementById('robuxInput').value) || 0;
    if (robux < 50) { 
      document.getElementById('robuxPrice').value = "Minimal 50 Robux"; 
      return; 
    }
    let harga = robux * 220;
    document.getElementById('robuxPrice').value = "Rp " + harga.toLocaleString();
  }

  function addCustomRobux() {
    let robux = parseInt(document.getElementById('robuxInput').value) || 0;
    if (robux < 50) { 
      return; // langsung batal tanpa alert
    }
    let harga = robux * 220;
    addToCart('robux-'+robux, robux + ' Robux', harga);
    updateCartCount();
  }

  function filterProducts(category) {
    currentFilter = category;
    const cards = document.querySelectorAll('.product-card');
    const navButtons = document.querySelectorAll('.nav-btn');
    const sectionTitle = document.getElementById('sectionTitle');
    
    navButtons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    const titles = {
      'all': 'All products',
      'garden': 'Grow a Garden',
      'robux': 'Top Up Robux',
      'voucher': 'Voucher'
    };
    sectionTitle.textContent = titles[category] || 'All products';
    
    cards.forEach(card => {
      if (category === 'all' || card.dataset.category === category) {
        card.style.display = 'block';
      } else {
        card.style.display = 'none';
      }
    });
  }

  function searchProducts() {
    const searchTerm = document.getElementById('searchBox').value.toLowerCase();
    const cards = document.querySelectorAll('.product-card');
    
    cards.forEach(card => {
      const productName = card.dataset.name.toLowerCase();
      const matchesSearch = productName.includes(searchTerm);
      const matchesFilter = currentFilter === 'all' || card.dataset.category === currentFilter;
      
      if (matchesSearch && matchesFilter) {
        card.style.display = 'block';
      } else {
        card.style.display = 'none';
      }
    });
  }

  function loadReceipt(){
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let html = '', total = 0;
    cart.forEach((item, index) => {
      let sub = item.price * item.quantity;
      total += sub;
      html += `<div class="receipt-item">
          <div>
            <div class="item-name-receipt">${item.name}</div>
            <div class="item-qty-price">
              <button class="qty-btn" onclick="changeQty(${index}, -1)">â€“</button>
              ${item.quantity}
              <button class="qty-btn" onclick="changeQty(${index}, 1)">+</button>
              x Rp ${item.price.toLocaleString()}
            </div>
          </div>
          <div>Rp ${sub.toLocaleString()}</div>
        </div>`;
    });
    if(cart.length === 0) html = '<p style="padding:15px;color:#000;">Keranjang kosong</p>';
    document.getElementById('receiptItems').innerHTML = html;
    document.getElementById('summaryTotal').textContent = 'Rp ' + total.toLocaleString();
  }

  function changeQty(index, delta){
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart[index].quantity += delta;
    if(cart[index].quantity <= 0) cart.splice(index, 1);
    localStorage.setItem('cart', JSON.stringify(cart));
    loadReceipt();
    updateCartCount();
  }

  function sendToWhatsApp(){
    let name = document.getElementById('customerName').value.trim();
    let username = document.getElementById('customerUsername').value.trim();
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    if(!name || !username || cart.length === 0){
      alert("Harap isi nama, username, dan pastikan keranjang tidak kosong!");
      return;
    }
    let msg = `Name: ${name}\nUsername: ${username}\n\nPesanan:\n`, total = 0;
    cart.forEach(item => {
      let sub = item.price * item.quantity;
      total += sub;
      msg += `${item.quantity} x ${item.name} - Rp ${sub.toLocaleString()}\n`;
    });
    msg += `\nTotal: Rp ${total.toLocaleString()}`;
    
    // kosongkan keranjang setelah confirm
    localStorage.removeItem('cart');
    updateCartCount();

    window.open(`https://wa.me/6282382052250?text=${encodeURIComponent(msg)}`, '_blank');
  }

  function showCheckout(){
    document.getElementById('mainHeader').style.display = 'none';
    document.getElementById('shopSection').style.display = 'none';
    document.getElementById('checkoutSection').style.display = 'block';
    loadReceipt();
  }

  function showShop(){
    document.getElementById('mainHeader').style.display = 'block';
    document.getElementById('shopSection').style.display = 'block';
    document.getElementById('checkoutSection').style.display = 'none';
    updateCartCount();
  }

  // inisialisasi awal
  updateCartCount();

     let appliedPromo = null; // promo yang dipakai

// daftar kode promo
const promoList = {
  "DISKON20": { type: "percent", value: 10, minSpend: 50000 },   // diskon 10% kalau belanja minimal Rp50.000
  "GAG123": { type: "nominal", value: 5000, minSpend: 30000 } // potongan Rp5.000 kalau belanja minimal Rp30.000
};

function applyPromo() {
  let code = document.getElementById("promoCode").value.trim().toUpperCase();
  let promoMsg = document.getElementById("promoMessage");

  if (appliedPromo) {
    promoMsg.textContent = "Promo sudah digunakan.";
    promoMsg.style.color = "red";
    return;
  }

  if (promoList[code]) {
    appliedPromo = { code, ...promoList[code] };
    promoMsg.textContent = "Promo " + code + " berhasil diterapkan!";
    promoMsg.style.color = "green";
    loadReceipt();
  } else {
    promoMsg.textContent = "Kode promo tidak valid.";
    promoMsg.style.color = "red";
  }
}

function loadReceipt(){
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  let html = '', total = 0;
  cart.forEach((item, index) => {
    let sub = item.price * item.quantity;
    total += sub;
    html += `<div class="receipt-item">
        <div>
          <div class="item-name-receipt">${item.name}</div>
          <div class="item-qty-price">
            <button class="qty-btn" onclick="changeQty(${index}, -1)">â€“</button>
            ${item.quantity}
            <button class="qty-btn" onclick="changeQty(${index}, 1)">+</button>
            x Rp ${item.price.toLocaleString()}
          </div>
        </div>
        <div>Rp ${sub.toLocaleString()}</div>
      </div>`;
  });
  if(cart.length === 0) html = '<p style="padding:15px;color:#000;">Keranjang kosong</p>';
  document.getElementById('receiptItems').innerHTML = html;

  // Hitung diskon
  let discount = 0;
  if (appliedPromo) {
    if (appliedPromo.type === "percent") {
      discount = total * (appliedPromo.value / 100);
    } else if (appliedPromo.type === "nominal") {
      discount = appliedPromo.value;
    }
  }

  let finalTotal = total - discount;
  if (discount > 0) {
    html += `<div class="receipt-item">
               <span>Diskon (${appliedPromo.code})</span><span>- Rp ${discount.toLocaleString()}</span>
             </div>`;
  }

  document.getElementById('summaryTotal').textContent = 'Rp ' + finalTotal.toLocaleString();
}

function sendToWhatsApp(){
  let name = document.getElementById('customerName').value.trim();
  let username = document.getElementById('customerUsername').value.trim();
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  if(!name || !username || cart.length === 0){
    alert("Harap isi nama, username, dan pastikan keranjang tidak kosong!");
    return;
  }
  let msg = `Name: ${name}\nUsername: ${username}\n\nPesanan:\n`, total = 0;
  cart.forEach(item => {
    let sub = item.price * item.quantity;
    total += sub;
    msg += `${item.quantity} x ${item.name} - Rp ${sub.toLocaleString()}\n`;
  });

  // diskon
  let discount = 0;
  if (appliedPromo) {
    if (appliedPromo.type === "percent") {
      discount = total * (appliedPromo.value / 100);
    } else if (appliedPromo.type === "nominal") {
      discount = appliedPromo.value;
    }
    msg += `\nPromo: ${appliedPromo.code} (-Rp ${discount.toLocaleString()})`;
  }

  let finalTotal = total - discount;
  msg += `\n\nTotal: Rp ${finalTotal.toLocaleString()}`;
  
  // kosongkan keranjang setelah confirm
  localStorage.removeItem('cart');
  appliedPromo = null; // reset promo
  updateCartCount();

  window.open(`https://wa.me/6282382052250?text=${encodeURIComponent(msg)}`, '_blank');
   }
     if (promoList[code]) {
  let promo = promoList[code];
  if (total >= promo.minSpend) {
    appliedPromo = { code, ...promo };
    promoMsg.textContent = `Promo ${code} berhasil diterapkan!`;
    promoMsg.style.color = "green";
    loadReceipt();
  } else {
    alert(`Minimal belanja Rp ${promo.minSpend.toLocaleString()} untuk pakai kode ini.`);
    promoMsg.textContent = `Minimal belanja Rp ${promo.minSpend.toLocaleString()} untuk pakai kode ini.`;
    promoMsg.style.color = "red";
  }
     }
    </script>
</body>
</html>
